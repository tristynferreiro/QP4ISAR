% ----------------------------------------------------
% Appendix A
% ----------------------------------------------------
\documentclass[class=report,11pt,crop=false]{standalone}
\input{../Style/ChapterStyle.tex}
\input{../FrontMatter/Abbreviations.tex}
\begin{document}
% ----------------------------------------------------
\appendix
\chapter{Additional Algorithm Verification and Validation \label{apndxA}}
% ----------------------------------------------------
\section{Measured Data Frames for Algorithm Verification} \label{apndxA:verification_frames}
    The \gls{isar} image frames and \gls{hrr} profiles in \autoref{fig:measured_data_frames} were generated from a single measured data set. As discussed in the \autoref{sec:theory_cptwl}, the size of the \gls{cptwl} affects the quality of the image. In this report the \gls{cptwl} is fixed at 128 which is the set value for all of the frames. The frames considered in this section were chosen from the larger subset as they illustrate the necessity for this selection process. 
    \begin{figure}[H]
        \begin{minipage}{0.9\linewidth}
            \begin{figure}
                \begin{tabular}{@{}cccc@{}}
                    \begin{subfigure}{0.25\linewidth}
                        \centering
                        \resizebox{\linewidth}{!}{\input{Figures/09Appendix/MeasuredDataFrames/Measured_HRRP_2464}}
                        \caption{Frame 1: unaligned HRR profiles. \label{subfig:measured_data_frames_HRRP_2464}}
                    \end{subfigure}
                    &
                    \begin{subfigure}{0.25\linewidth}
                        \centering
                        \resizebox{\linewidth}{!}{\input{Figures/09Appendix/MeasuredDataFrames/Measured_HRRP_2970}}
                        \caption{Frame 2: unaligned HRR profiles.}
                    \end{subfigure}
                    &
                    \begin{subfigure}{0.25\linewidth}
                        \centering
                        \resizebox{\linewidth}{!}{\input{Figures/09Appendix/MeasuredDataFrames/Measured_HRRP_3827}}
                        \caption{Frame 3: unaligned HRR profiles.}
                    \end{subfigure}
                    &
                    \begin{subfigure}{0.25\linewidth}
                        \centering
                        \resizebox{\linewidth}{!}{\input{Figures/09Appendix/MeasuredDataFrames/Measured_HRRP_4189}}
                        \caption{Frame 4: unaligned HRR profiles. \label{subfig:measured_data_frames_HRRP_4189}}
                    \end{subfigure}
                    \\
                    \begin{subfigure}{0.25\linewidth}
                        \centering
                        \resizebox{\linewidth}{!}{\input{Figures/09Appendix/MeasuredDataFrames/Measured_ISAR_2464}}
                        \caption{Frame 1: unfocused ISAR image.}
                    \end{subfigure}
                    &
                    \begin{subfigure}{0.25\linewidth}
                        \centering
                        \resizebox{\linewidth}{!}{\input{Figures/09Appendix/MeasuredDataFrames/Measured_ISAR_2970}}
                        \caption{Frame 2: unfocused ISAR image.}
                    \end{subfigure}
                    &
                    \begin{subfigure}{0.25\linewidth}
                        \centering
                        \resizebox{\linewidth}{!}{\input{Figures/09Appendix/MeasuredDataFrames/Measured_ISAR_3827}}
                         \caption{Frame 3: unfocused ISAR image.}
                    \end{subfigure}
                    &
                    \begin{subfigure}{0.25\linewidth}
                        \centering
                        \resizebox{\linewidth}{!}{\input{Figures/09Appendix/MeasuredDataFrames/Measured_ISAR_4189}}
                         \caption{Frame 4: unfocused ISAR image.}
                    \end{subfigure}
                \end{tabular}
                \caption{Different \gls{isar} image frames produced from one measured data set. \label{fig:measured_data_frames}}
            \end{figure}
        \end{minipage}
        \vspace*{-1.5\baselineskip}
    \end{figure}


    Each frame provides a look of the same object over a different frame in time. Some of these are not suitable for verifying the \gls{ra} and \gls{af} processing algorithms considered in this report because of characteristics mentioned in \autoref{subsec:theory_isar}. The profiles in \autoref{subfig:measured_data_frames_HRRP_2464} and \autoref{subfig:measured_data_frames_HRRP_4189} have at least one clear \gls{ds} and are within the frame which makes them the ideal choice for verifying \gls{ra} algorithms. \autoref{fig:measured_data_frames_RA} shows the \gls{hrr} profiles of these two frames after applying Simple Correlation \gls{ra}, \autoref{alg:corr_RA}.
    \begin{figure} [H]
        \centering
        \begin{subfigure}{0.4\textwidth}
            \centering
            \resizebox{\linewidth}{!}{\input{Figures/09Appendix/MeasuredDataFrames/Measured_SCRA_HRRP_2464}}
        \end{subfigure}
        \begin{subfigure}{0.4\textwidth}
            \centering
            \resizebox{\linewidth}{!}{\input{Figures/09Appendix/MeasuredDataFrames/Measured_SCRA_HRRP_4189}} 
        \end{subfigure}
        \caption{Frame 1 (left) and 4 (right): range-aligned \gls{hrr} profiles.} \label{fig:measured_data_frames_RA}
        \vspace*{-1.5\baselineskip} 
    \end{figure}
     As discussed in \autoref{subsec:theory_isar}, not all frames of \gls{isar} data can be focused due to the object's motion, the \gls{cptwl}, and other factors. It then follows that some measured data frames will not be perfectly range-aligned or autofocused. Comparing the profile frames in \autoref{fig:measured_data_frames_RA}, the profiles in Frame 1 are better aligned than those in Frame 4. Furthermore, in Frame 1, a distinct \gls{ds} exists at range bin 14. For validation testing, it is desirable to choose the best case data because the goal is to demonstrate that the algorithms work on measured data. The limitations of the algorithms were investigated and discussed through verification testing where non-ideal data is used. For these reasons, frame 1 was used for validation testing in \autoref{ch:algorithmV&V}. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Scaling Factor in Dominant Scatterer Selection \label{apndxA:scale_factor_effect}}
In the Haywood \gls{af} algorithm, given in \autoref{alg:haywood_AF}, phase compensation is calculated based on the phase history of the \gls{ds} over all profiles. A set of selection criteria is used to determine the \gls{ds}:
\begin{itemize}
    \item Criterion 1: The set of candidate dominant scatterers includes all scatterers with a power greater than the average scatterer power (the threshold value) across all range bins.
    \item Criterion 2: The \gls{ds} is the candidate scatterer with the minimum amplitude variance.
\end{itemize}
%initially choosing candidate scatterers, from which the one with the minimum variance is selected as the \gls{ds}. The candidate scatterers are those with a power greater than the average scatterer power (the threshold value). 
As discussed in \autoref{theory:noise} of the theory chapter, external interference sources can influence the phase of the received signal. Consequently, selecting a scatterer severely affected by noise will impair the performance of the \gls{af}, resulting in a less focused \gls{isar} image compared to choosing a scatterer with less noise interference. Therefore, filtering is essential to enhance the performance of this algorithm. To this effect, an average power scaling factor (sf) was introduced to select higher power scatterers as candidates. 
%This is advantageous because higher power scatterers tend to have a phase history that is less affected by noise. 
The implementation of the sf variable is shown in \autoref{code:scale_factor}.
% !!!!!!!!!!!!!! DO NOT INDENT IT MESSES UP THE LATEX !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
\begin{lstlisting}[caption={\textsc{Matlab} code for selecting candidate dominant scatterers.},label={code:scale_factor}]
candidate_scatterers_idx = find(power_scatterers>scaling_factor*average_power_scatterers);
\end{lstlisting}
% !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
\gls{af} is applied to both the Simple Correlation and Haywood range-aligned profiles. The following subsections discuss the effect of the sf value on the selection of the \gls{ds} and subsequently the \gls{isar} image for both sets of range-aligned profiles.

    %***************************************************************************************%    
    \subsection{Using Simple Correlation Range-aligned Profiles} \label{subsec:sf_corrRA}
    The Simple correlation range-aligned \gls{isar} image, as shown in \autoref{fig:sf_corrRA_isar}, is included for comparison to the autofocused \gls{isar} images, \autoref{fig:sf_corrRA}(a)-(c). Additionally, the \gls{isar} image generated when the object had no translational motion, as shown in \autoref{subfig:sf_focused_isar}, is a reference for the expected appearance of a focused image.
    
    \begin{figure}[H]
        \centering
        \begin{minipage}{0.4\linewidth}
            \begin{subfigure}{\linewidth}
                \centering
                \resizebox{\linewidth}{!}{\input{Figures/04AlgoV&V/02CorrRA/SCRA_Sim_ISAR_1mps_6deg}}
            \end{subfigure}
            \caption{Range-aligned image.\label{subfig:sf_corrRA_isar}}   
        \end{minipage}
        \hspace{1cm}
        \begin{minipage}{0.4\linewidth}
            \begin{subfigure}{\linewidth}
                \centering
                \resizebox{\linewidth}{!}{\input{Figures/04AlgoV&V/Sim_ISAR_0mps_6deg}}
            \end{subfigure} 
            \caption{Reference focused image.\label{subfig:sf_focused_isar}}
        \end{minipage}
        \vspace*{-1.5\baselineskip}
    \end{figure}
    
    \autoref{fig:sf_corrRA} shows autofocused ISAR images and plots demonstrating the fulfillment of both selection criteria for various \gls{sf} values. When comparing \autoref{fig:sf_corrRA}(d)-(f), it becomes evident that as the \gls{sf} increases, the number of candidate scatterers decreases. Consequently, the number of scatterers to which criterion 2 is applied also decreases, leading to the selection of scatterers with higher amplitude variance, as demonstrated in \autoref{fig:sf_corrRA}(g)-(i). Overall, higher power scatterers are chosen as the \gls{ds}, as shown by the larger circle in \autoref{fig:sf_corrRA}(d)-(f).

    Before comparing the autofocused \gls{isar} images, it is important to recall that sidelobes formed when using the \gls{fft} can result in Doppler spreading in \gls{isar} images, as discussed in \autoref{sec:theory_isar_complications}.  Although windowing was applied to minimise these sidelobes, it was not completely effective, as is evident in the images throughout this section. The spectral spreading caused by these sidelobes is present in the range-aligned image, and persists in the autofocused images.

    The impact of choosing a higher power \gls{ds} is reflected in \autoref{fig:sf_corrRA}(a) and (c), where, with increasing \gls{sf}, the \gls{isar} image becomes more focused. This is evident by comparing the \gls{ds} (brightest scatterer) in both of the images; in (c), the \gls{ds} power resides mostly at zero-Doppler, which is not the case in (a). This is consistent across most scatterers, where the power mostly resides in one place in (c) but not in (a). While \autoref{fig:sf_corrRA}(c) still exhibits effects of spectral spreading, which is indicated by the presence of 'shadows' in the image, it more closely resembles \autoref{subfig:sf_focused_isar} than (a). This is because the center of the image in (c) is distinctly positioned at zero-Doppler, and the Doppler spread is more evidently attributed to sidelobes.

    In the case of \autoref{fig:sf_corrRA}(b), the spectral spreading results in a notably defocused image. Unlike in \autoref{fig:sf_corrRA}(a), the spreading in (b) could be mistaken for another object, especially without prior knowledge that it is caused by sidelobes. The spreading is likely due to the selection of a \gls{ds} with a phase, which, when applied to all profiles and passed through the \gls{fft}, increases integrated sidelobes. Importantly, this doesn't imply that a \gls{sf} of 5 is inherently less desirable than a \gls{sf} of 1. Rather, it is a consequence of thee characteristics of this Simple Correlation dataset's characteristics and could occur regardless of the chosen \gls{sf}. This emphasises the importance of considering and processing multiple frames of \gls{hrr} profiles in \gls{isar} imaging to obtain a high-quality image of the object.

    The image focus can be quantitatively measured using the \gls{ic} value calculated as in \autoref{eq:image_contrast}. The values are \textbf{34.08}, \textbf{19.58}, and \textbf{38.42} for \autoref{fig:sf_corrRA}(a)-(c), respectively. These values indicate that (c) has the highest \gls{ic} value, confirming the previous analysis that the image is most focused for a \gls{sf} of 10. Therefore, by comparing \autoref{fig:sf_corrRA}(a) and (c) and their respective \gls{ic} values, it is evident that introducing a \gls{sf} can lead to a more focused \gls{isar} image. Specifically, for these Simple Correlation range-aligned profiles, a \gls{sf} of 10 produces the most focused image.
     
    % Grid of the HRRP and ISAR images SCRA
    \begin{figure}[H]
    \centering
    \begin{minipage}{0.98\linewidth}
        \begin{tabular}{@{}ccc@{}}
            \begin{subfigure}{0.33\linewidth}
                \centering
                \resizebox{\linewidth}{!}{\input{Figures/09Appendix/ScalingFactor/CorrRA/ISAR/HayAF_SCRA_Sim_ISAR_sf1}}
                \caption{Autofocused \gls{isar} image, \\ sf = 1.\label{subfig:sf1_corrRA_isar}}
            \end{subfigure}
            &
            \begin{subfigure}{0.33\linewidth}
                \centering
                \resizebox{\linewidth}{!}{\input{Figures/09Appendix/ScalingFactor/CorrRA/ISAR/HayAF_SCRA_Sim_ISAR_sf5}}
                \caption{Autofocused \gls{isar} image, \\ sf = 5.\label{subfig:sf5_corrRA_isar}}
            \end{subfigure}
             &
            \begin{subfigure}{0.33\linewidth}
                \centering
                \resizebox{\linewidth}{!}{\input{Figures/09Appendix/ScalingFactor/CorrRA/ISAR/HayAF_SCRA_Sim_ISAR_sf10}}
                \caption{Autofocused \gls{isar} image, \\ sf = 10.\label{subfig:sf10_corrRA_isar}}
            \end{subfigure}
            \\
            \begin{subfigure}{0.33\linewidth}
                \centering
                \resizebox{\linewidth}{!}{\input{Figures/09Appendix/ScalingFactor/CorrRA/Power/HayAF_SCRA_Sim_Power_sf1}}
                \caption{Scatterer power, \\ sf = 1.\label{subfig:sf1_corrRA_power}}
            \end{subfigure}
             &
            \begin{subfigure}{0.33\linewidth}
                \centering
                \resizebox{\linewidth}{!}{\input{Figures/09Appendix/ScalingFactor/CorrRA/Power/HayAF_SCRA_Sim_Power_sf5}}
                \caption{Scatterer power, \\ sf = 5.\label{subfig:sf5_corrRA_power}}
            \end{subfigure}
             &
            \begin{subfigure}{0.33\linewidth}
                \centering
                \resizebox{\linewidth}{!}{\input{Figures/09Appendix/ScalingFactor/CorrRA/Power/HayAF_SCRA_Sim_Power_sf10}}
                \caption{Scatterer power, \\ sf = 10.\label{subfig:sf10_corrRA_power}}
            \end{subfigure}
            \\
            \begin{subfigure}{0.33\linewidth}
                \centering
                \resizebox{\linewidth}{!}{\input{Figures/09Appendix/ScalingFactor/CorrRA/Variance/HayAF_SCRA_Sim_Var_sf1}}
                \caption{Scatterer amplitude variance, \\ sf = 1.\label{subfig:sf1_corrRA_var}}
            \end{subfigure}
             &
            \begin{subfigure}{0.33\linewidth}
                \centering
                \resizebox{\linewidth}{!}{\input{Figures/09Appendix/ScalingFactor/CorrRA/Variance/HayAF_SCRA_Sim_Var_sf5}}
                \caption{Scatterer amplitude variance, \\ sf = 5.\label{subfig:sf5_corrRA_var}}
            \end{subfigure}
             &
            \begin{subfigure}{0.33\linewidth}
                \centering
                \resizebox{\linewidth}{!}{\input{Figures/09Appendix/ScalingFactor/CorrRA/Variance/HayAF_SCRA_Sim_Var_sf10}}
                \caption{Scatterer amplitude variance, \\ sf = 10.\label{subfig:sf10_corrRA_var}}
            \end{subfigure}
        \end{tabular}
        \caption{\gls{ds} selection and autofocused \gls{isar} images for different scaling factors using Simple Correlation \gls{ra} \gls{hrr} profiles.\label{fig:sf_corrRA}}
    \end{minipage}
    \vspace*{-1.5\baselineskip}
    \end{figure}

    \subsection{Using Haywood Range-aligned Profiles}
    The Haywood range-aligned \gls{isar} image, as shown in \autoref{fig:sf_hayRA_isar}, is included for comparison to the autofocused \gls{isar} images, \autoref{fig:sf_hayRA}(a)-(c). Additionally, the \gls{isar} image generated when the object had no translational motion, as shown in \autoref{subfig:sf_focused_isar}, is a reference for the expected appearance of a focused image.
    
    \begin{figure}[H]
        \centering
        \begin{minipage}{0.4\linewidth}
            \begin{subfigure}{\linewidth}
                \centering
                \resizebox{\linewidth}{!}{\input{Figures/04AlgoV&V/03HayRA/HayRA_Sim_ISAR_1mps_6deg}}
            \end{subfigure}
            \caption{Range-aligned image.\label{subfig:sf_corrRA_isar}}   
        \end{minipage}
        \hspace{1cm}
        \begin{minipage}{0.4\linewidth}
            \begin{subfigure}{\linewidth}
                \centering
                \resizebox{\linewidth}{!}{\input{Figures/04AlgoV&V/Sim_ISAR_0mps_6deg}}
            \end{subfigure} 
            \caption{Reference focused image.\label{subfig:sf_focused_isar}}
        \end{minipage}
        \vspace*{-1.5\baselineskip}
    \end{figure}

    \autoref{fig:sf_hayRA} shows autofocused \gls{isar} images and plots demonstrating the fulfillment of both selection criteria for various \gls{sf} values. Similar to the observations as described in \autoref{subsec:sf_corrRA}, can be made for the figures in \autoref{fig:sf_hayRA}; as the \gls{sf} increases \gls{ds} scatterers with higher power are selected. As previously discussed in \autoref{subsec:sf_corrRA}, the \gls{isar} images in this subsection are also affected by Doppler spreading caused by sidelobes.
    
    Comparing \autoref{fig:sf_hayRA}(a) to (b) and (c) shows that when a higher power \gls{ds} is selected, the \gls{isar} image becomes more focused, indicated by each scatterer's power residing mostly in one place. This reaffirms the conclusion drawn in \autoref{subsec:sf_corrRA}; introducing a \gls{sf} leads to a more focused image. Unlike the previous section, where scaling factors of 5 and 10 produced different \gls{ds} selections, in this case, they both lead to the same \gls{ds} choice. This consequently results in identical focused images in \autoref{fig:sf_hayRA}(a) and (b). Thus, the effectiveness and necessity of a scaling factor (SF) depend on the dataset; however, both the previous section and this section show that a scaling factor of 10 is suitable.

    Notably, for a scaling factor of 5, the spectral spreading observed in \autoref{subfig:sf5_corrRA_isar} does not appear in \autoref{fig:sf_hayRA}(b). This further reinforces that the image defocusing observed in the previous section when using a \gls{sf} of 5, is a consequence of the characteristics of the Simple Correlation dataset.
    
    The image focus can be quantitatively measured using the \gls{ic} value calculated as in \autoref{eq:image_contrast}. The values are \textbf{46.14}, \textbf{50.03}, and \textbf{50.03} for \autoref{fig:sf_hayRA}(a)-(c), respectively. These values indicate that both (b) and (c) have the highest \gls{ic} value, confirming the previous analysis that the image is most focused for scaling factors of 5 and 10. In summary, comparing \autoref{fig:sf_corrRA}(a)-(c) and their respective \gls{ic} values shows that introducing a \gls{sf} can result in a more focused \gls{isar} image. Specifically, for these Haywood Correlation range-aligned profiles, a \gls{sf} of 5 and 10 produces the most focused image.
    
    % Grid of the HRRP and ISAR images HaywoodRA
    \begin{figure}[H]
    \begin{minipage}{0.98\linewidth}
        \begin{tabular}{@{}ccc@{}}
            \begin{subfigure}{0.33\linewidth}
                \centering
                \resizebox{\linewidth}{!}{\input{Figures/09Appendix/ScalingFactor/HayRA/ISAR/HayAF_HayRA_Sim_ISAR_sf1}}
                \caption{Autofocused \gls{isar} image, \\ sf = 1.\label{subfig:sf1_hayRA_isar}}
            \end{subfigure}
            &
            \begin{subfigure}{0.33\linewidth}
                \centering
                \resizebox{\linewidth}{!}{\input{Figures/09Appendix/ScalingFactor/HayRA/ISAR/HayAF_HayRA_Sim_ISAR_sf5}}
                \caption{Autofocused \gls{isar} image, \\ sf = 5.\label{subfig:sf5_hayRA_isar}}
            \end{subfigure}
             &
            \begin{subfigure}{0.33\linewidth}
                \centering
                \resizebox{\linewidth}{!}{\input{Figures/09Appendix/ScalingFactor/HayRA/ISAR/HayAF_HayRA_Sim_ISAR_sf10}}
                \caption{Autofocused \gls{isar} image, \\ sf = 10.\label{subfig:sf10_hayRA_isar}}
            \end{subfigure}
            \\
            \begin{subfigure}{0.33\linewidth}
                \centering
                \resizebox{\linewidth}{!}{\input{Figures/09Appendix/ScalingFactor/HayRA/Power/HayAF_HayRA_Sim_Power_sf1}}
                \caption{Scatterer power, \\ sf = 1.\label{subfig:sf1_hayRA_power}}
            \end{subfigure}
             &
            \begin{subfigure}{0.33\linewidth}
                \centering
                \resizebox{\linewidth}{!}{\input{Figures/09Appendix/ScalingFactor/HayRA/Power/HayAF_HayRA_Sim_Power_sf5}}
                \caption{Scatterer power, \\ sf = 5.\label{subfig:sf5_hayRA_power}}
            \end{subfigure}
             &
            \begin{subfigure}{0.33\linewidth}
                \centering
                \resizebox{\linewidth}{!}{\input{Figures/09Appendix/ScalingFactor/HayRA/Power/HayAF_HayRA_Sim_Power_sf10}}
                \caption{Scatterer power, \\ sf = 10.\label{subfig:sf10_hayRA_power}}
            \end{subfigure}
            \\
            \begin{subfigure}{0.33\linewidth}
                \centering
                \resizebox{\linewidth}{!}{\input{Figures/09Appendix/ScalingFactor/HayRA/Variance/HayAF_HayRA_Sim_Var_sf1}}
                \caption{Scatterer amplitude variance, \\ sf = 1.\label{subfig:sf1_hayRA_var}}
            \end{subfigure}
             &
            \begin{subfigure}{0.33\linewidth}
                \centering
                \resizebox{\linewidth}{!}{\input{Figures/09Appendix/ScalingFactor/HayRA/Variance/HayAF_HayRA_Sim_Var_sf5}}
                \caption{Scatterer amplitude variance, \\ sf = 5.\label{subfig:sf5_hayRA_var}}
            \end{subfigure}
             &
            \begin{subfigure}{0.33\linewidth}
                \centering
                \resizebox{\linewidth}{!}{\input{Figures/09Appendix/ScalingFactor/HayRA/Variance/HayAF_HayRA_Sim_Var_sf10}}
                \caption{Scatterer amplitude variance, \\ sf = 10.\label{subfig:sf10_hayRA_var}}
            \end{subfigure}
        \end{tabular}
        \caption{\gls{ds} selection and autofocused \gls{isar} images for different scaling factors using Haywood \gls{ra} \gls{hrr} profiles.\label{fig:sf_hayRA}}
    \end{minipage}
    \vspace*{-1.5\baselineskip}
    \end{figure}



% ----------------------------------------------------
\ifstandalone
\bibliography{../Bibliography/References.bib}
\printnoidxglossary[type=\acronymtype,nonumberlist]
\fi
\end{document}
% ----------------------------------------------------