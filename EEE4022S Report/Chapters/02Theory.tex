% ----------------------------------------------------
% Theory
% ----------------------------------------------------
\documentclass[class=report,11pt,crop=false]{standalone}
\input{../Style/ChapterStyle.tex}
\input{../FrontMatter/Abbreviations.tex}
\begin{document}
\ifstandalone
\tableofcontents
\fi
% ----------------------------------------------------
\chapter{Theoretical Background \label{ch:theory}} 
% ----------------------------------------------------
% Characteristics of the theory section(s)
% •	Clear, logical development, relevant and accurate
% •	The theory provides a foundation for the design/research work performed later in the work
% •	There is balance between text and diagrams when describing the important theoretical concepts 

This chapter provides the theoretical foundation for \gls{isar} imaging concepts used throughout this report. It concentrates on exploring general radar principles and their context in \gls{isar}. The discussed topics encompass high-resolution radar, range-Doppler image formation, motion compensation, and measures of \gls{isar} imaging quality.

% FOOT NOTES TO ADD 
% - term waveform refers to the signal generated and transmittd by the radar. term signal refers to the radiated object's response to the waveform. However it might be used interchangeably

%This section provides a mathematical description of the theory of ISAR. It sum- marises the principles of ISAR and derives the conventional mathematical system model that is used in the ISAR literature. Furthermore, it discusses the sampling requirements that need to be met, in order to prevent ambiguity in the down- range and cross-range dimensions of an ISAR image. The other topics discussed are the image projection plane, the image-generating Doppler components and the signal processing steps that are required for ISAR motion compensation.

% \section{General Radar Concepts}% PoMr
% \subsection{Signal to Noise Ratio (SNR)}
% - coherent processing affects the SNR. More coherent processing = more SNR. %Zyweck ch 2.5.3

% \section{General Radar Concepts}
%     %*********************************************************************************%
%     \subsection{RCS and Scatterers}
%     % 2.17.2 POMR
%      RCS and what are scatterers? What is a dominant scatterer? What does it tell us about that point?
%     %         \begin{itemize}
%     %             \item RCS of a target is used to characterize the target. It depends on the target’s size, geometry, material, transmitted frequency, polarization of the transmitter and receiver, and aspect angles of the target relative to the radar transmitter and the receiver, respectively [1–4]. % Martorella ch 2.1.1
%     %             \item measured using square meters (m\^2) or log-scale(dB)
            
% % What is a DS
\section{Noise} \label{theory:noise}
% chapter 2.5 Pomr
The \gls{snr} represents the ratio of the received signal power, $P_r$, to the noise power, $P_n$. This noise power is usually considered to be the effect of the radar receiver's thermal noise. %ch12.2.1 pomr 
% chapter 2.5 Pomr
However, signal interference in radar systems can result from various sources beyond receiver thermal noise \cite{pomr}. The \gls{sir} takes all interference sources into account and is determined by the ratio of $P_r$ to the total interference. It is given in \cite{pomr} as
\begin{equation}\label{eq:sir}
    SIR = \frac{P_r}{N + C + J}
\end{equation}
where N is the receiver thermal noise, C is clutter, and J is jamming noise. This equation does not include all possible interference sources, but rather shows that $P_n$ is the sum of multiple interference factors. The \gls{sir} is what determines the radar performance, although it is often simplified to \gls{snr}.

%ch12.2.1 pomr
Interference not only impacts the power of the received signal but also its phase. As discussed in \autoref{theory:doppler_shift}, the Doppler shift is determined using the phase of the received signal. Any sources of interference can introduce phase modulation to the signal, consequently affecting the accuracy of calculated Doppler shifts. The influence of various interference sources on the received signal is discussed in Chapter 12.2 and throughout \cite{pomr}. 
A critical consideration for this report is that phase noise leads to Doppler spectral spreading. In the context of \gls{sfw} and synthetic aperture systems, it can also result in increased sidelobes during image processing, consequently distorting the image in an undesirable manner.%ch12.2.4 pomr effect oh phase noise on imaging

\section{Radar Resolution Concepts in ISAR \label{sec:theory_resolution}}
Radar resolution defines a radar's ability to resolve objects or scatterers closely spaced in terms of range, angle, or Doppler frequency. If the objects are closer spaced than the radar's resolution, they cannot be reliably resolved \cite{pomr}. The resolution requirements of radar systems vary depending on their specific application. For example, \gls{isar} imaging employs high-resolution radar to form detailed images.
    %*********************************************************************************%
    \subsection{Down-range Resolution}
    An object's range, $R$, is determined by measuring the round-trip time delay of the transmitted signal and its echoed return. In general, the range resolution of a radar describes its ability to resolve range-separated objects. In \gls{isar} imaging this concept is known as the down-range resolution and describes the ability to resolve individual scatterers on the object \cite{ISARtextbook_Martorella}. % Martorella ch1.4
    The range resolution is inversely proportional to the bandwidth of the radar system, mathematically, this relationship is approximated as % PoMR ch20.3 
    \begin{equation} \label{eq:range_resolution}
    \Delta R = \frac{c}{2BW}
    \end{equation}
    where \(\Delta R\) is the range resolution, \(BW\) is the bandwidth and \(c\) is the speed of light constant \cite{pomr}. 
    % The finer the resolution (smaller intervals of range that can be measured), the more features on the object can be distinguished.
    %*********************************************************************************%
    \subsection{Doppler Shift} \label{theory:doppler_shift}%pomr pg 275
    If there is relative motion between the radar and an object, the frequency of the returned signal will differ from the frequency of the transmitted signal. This is known as the Doppler effect and the difference in frequency is the Doppler shift, $f_D$ . Doppler shift is a valuable in \gls{isar} image formation. This is because object scatterers have different speeds, resulting in distinct Doppler shifts, which can be used to calculate the spacing between points \cite{meng_HRRP_alignment}. A thorough explanation of this concept is given in Chapter 2 and 8 of \cite{pomr}. In a mono-static radar system the Doppler frequency can be mathematically described in terms of the radial velocity of the target as
    \begin{equation}\label{eq:doppler_shift}
         f_D = \pm \frac{2v}{\lambda} cos \beta \hspace{1cm} \lambda = \frac{f_{transmit}}{c}
    \end{equation}
    where $\lambda$ is the wavelength of the transmitted signal, $\beta$ the angle between the velocity vector of the target and the \gls{rlos} and  $v cos \beta$ is the radial velocity. Radial velocity is the relative velocity between the radar and the target along the \gls{rlos}. \autoref{fig:doppler_shift} is an illustration to aid understanding of the concepts and terms discussed in this section.
    
    \begin{figure}[h]
        \centering
        \resizebox{0.55\linewidth}{!}{\input{Figures/02Theory/Doppler_1}}
        \caption{Doppler shift relationship with radial velocity of target.\label{fig:doppler_shift}}
    \end{figure}
    %*********************************************************************************%
    \subsection{Doppler Resolution} % Chen ch 1.4.2
    Doppler resolution refers to the smallest separation between targets in terms of Doppler frequency, $f_D$, that the radar can resolve \cite{pomr}. The relationship between Doppler resolution and the radar's dwell time, $T_d$, is given as
    % Doppler resolution refers to a radar's ability to resolve closely spaced targets in terms of Doppler frequency, i.e the smallest change in $f_D$ that can be resolved. The Fourier concept of two observed sinusoids is applied to determine the Doppler resolution: two targets can be reliably resolved when the difference of the two oscillating frequencies is greater than the single-pulse bandwidth, which is determined by the \gls{cpi}. The inverse relationship between Doppler resolution and the \gls{cpi} is mathematically described as
    \begin{equation} \label{eq:doppler_resolution}
        \Delta f_D = \frac{1}{T_{d}}
    \end{equation}
    Chapter 8.4.7 of \cite{pomr} provides a thorough explanation of the relationship. %If two sinusoids are observed over a time interval, T, they can only be resolved if the difference in their frequencies is greater than 1/T. This is because if we look at the spectrum of these sinusoids, the closer they are the more they interfere with one another and become difficult to differentiate: If two sinusoids are observed over a time interval, T, they can only be resolved if the difference in their frequencies is greater than 1/T. This is because if we look at the spectrum of these sinusoids, the closer they are the more they intefer with one another and become difficult to differentiate:

    %**********************************************************************************
    \subsection{Range and Doppler Ambiguities} % POMR ch1.5.2 pg23 and 1.5.3.2
    The maximum range between the radar and object that can be unambiguously measured is given by
    \begin{equation} \label{eq:range_unambiguous}
        R_{u} = \frac{c}{2 \cdot PRF}
    \end{equation}
    where $c$ is the speed of light constant \cite{pomr}. The greatest range of Doppler shifts that can be unambiguously measured is defined in \cite{pomr} as
    \begin{equation}\label{eq:doppler_unambiguous}
        f_{D_{u}} = \pm \frac{PRF}{2}
    \end{equation}
    There is a clear trade-off between the ambiguity of the range and Doppler shift measurements. Increasing the \gls{prf} will better the unambiguous Doppler range but will decrease the unambiguous radar range. This trade-off and its affect on radar systems is thoroughly discussed in \cite{pomr}. 
    % \gls{prf} needs to be strategically chosen to allow for a middle ground between these trade-offs or a best fit for the system. Low \gls{prf} systems will be unambiguous in range, high \gls{prf} systems will always have unambiguous Doppler shift measuremetns and a medium \gls{prf} system will have unambiguous range and Doppler shift measurements. These concepts are holistically discussed in \cite{pomr}.
    % read cha 14.3 POMR
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{High Resolution Radar Waveforms \label{sec:theory_hrr_waves}}
Low resolution radar systems can only resolve objects as a whole. In contrast, high resolution radar systems can resolve individual scatterers \footnote{When a radar transmits an electromagnetic wave at an object, that object reflects or scatters the wave. As discussed by Wehner \cite{Wehner1995}, an object is made up of individual reflection points called scatterers or scattering centers. More about these concepts can be found in \cite{pomr,Wehner1995}} on an object. To achieve finer range resolution, these systems employ waveforms with varying interpulse frequencies that create a wide effective bandwidth \cite{pomr}. %ch20.5.2
Frequency modulation of signals is used to achieve the varying interpulse frequencies. Chirp pulse \footnote{Also known as a linear frequency modulated pulsed waveform}, phase-coded waveforms and pulsed \gls{sfw} exist for this effect \cite{ISARtextbook_Martorella}. To increase Doppler resolution, pulsed waveforms with high \cite{prf} are employed.
    %***************************************************************************************%
    \subsection{Stepped Frequency Waveform (SFW)\label{subsec:theory_sfw}}
     \gls{sfw} signals are discussed in detail in \cite{ISARtextbook_Martorella,ISARtextbook_Matlab,Wehner1995}, this section highlights the core concepts. 
     A \gls{sfw} waveform, shown in \autoref{fig:theory_sfcw}, can be described as a series of pulses with increasing carrier frequencies of fixed increments. Mathematically, the carrier frequency of each pulse can be expressed as
    \begin{equation} \label{eq:frequencies_sfw}
        f_n = f_0 + (n-1) \cdot \Delta f \hspace{0.5cm} (n = 1,..., N)
    \end{equation}
    where $f_0$ is the frequency of the first pulse and $\Delta f$ is the frequency step \cite{ISARtextbook_Martorella}.  
    
    % The pulses are sent out at fixed intervals which is the waveform's \gls{pri}. The \gls{pri} and the signal's \gls{prf} are related as \(  T_{\gls{pri}} = \frac{1}{T_{\gls{prf}}} \).
    \begin{figure}
        \centering
        \resizebox{1\linewidth}{!}{\input{Figures/02Theory/SFW_waveform}}
        \caption{Transmitted Stepped Frequency Waveform.\label{fig:theory_sfcw}}
    \end{figure}
    The interpulse frequency modulation results in a wide effective bandwidth
    \begin{equation} \label{eq:bw_sfw}
        BW_{eff} = N \cdot \Delta f
    \end{equation}
    where \(N\) is the number of pulses in the waveform and \(\Delta f\) is the frequency step. Wehner \cite{Wehner1995} derives the unambiguous range of this waveform as
    \begin{equation} \label{eq:range_unambiguous_sfw}
        R_{ua} = \frac{c}{2\Delta f}
    \end{equation}
    and the range resolution in \autoref{eq:range_resolution}, is redefined in terms of the effective bandwidth as
    \begin{equation}  \label{eq:range_resolution_sfw}
        \Delta R = \frac{c}{2 \cdot N \cdot \Delta f}
    \end{equation}
    By increasing the number of pulses, size of the frequency step or both, a wider effective bandwidth can be achieved. The wide bandwidth capability of \gls{sfw} is advantageous for high resolution radar applications like \gls{isar}.
    
    In practice, the radar will transmit a sequence of \gls{sfw} signals as illustrated in \autoref{fig:theory_sfcw_burst_train}. Each sequence consists of M \gls{sfw} signals, referred to as bursts, with each burst containing N frequency-stepped pulses \cite{ISARtextbook_Martorella}.
    \begin{figure}[h]
        \centering
        \resizebox{0.8\linewidth}{!}{\input{Figures/02Theory/SFW_pulse_train}}
        \caption{Transmitted \gls{sfw} burst train containing M bursts, each with N frequency-stepped pulses.  \label{fig:theory_sfcw_burst_train}}
    \end{figure}
    As indicated in \autoref{fig:theory_sfcw_burst_train} the burst repetition interval is 
    \begin{equation}  \label{eq:bri_sfw}
        T_{burstInterval} = N \cdot T_{\gls{pri}} 
    \end{equation}
    where $N$ is the number of pulses in the burst and $T_{\gls{pri}}$ is the \gls{sfw} signal's \gls{pri}. The dwell time per burst is \(T_d = N \cdot T_{PRI}\) \cite{pomr} %ch2.10
    and the Doppler resolution given in
    \autoref{eq:doppler_resolution} can be redefined as
    \begin{equation} \label{eq:doppler_resolution_sfw}
        \Delta f_D = \frac{1}{N \cdot T_{PRI}}
    \end{equation}
    The total \gls{cpi} of a \gls{sfw} radar is dependent on the number of bursts and is defined by \cite{ISARtextbook_Matlab} as
    \begin{equation}  \label{eq:cpi_sfw}
        T_{CPI} = M \cdot T_{burst} = M \cdot N \cdot T_{\gls{pri}}
    \end{equation}
    %Since the Doppler resolution is inversely proportional to the the \gls{cpi}, \autoref{eq:doppler_resolution} can be redefined as
    % \begin{equation} \label{eq:doppler_resolution_sfw}
    %     \Delta f_D = \frac{1}{M \cdot N \cdot T_{\gls{pri}}}
    % \end{equation}
    % where $M$ is the number of bursts, $N$ is the number of stepped frequency pulses per burst and $T_{\gls{pri}}$ is the \gls{sfw} \gls{pri} .

    %***************************************************************************************%
    \subsection{High Resolution Range Profile (\acrshort{hrrp})\label{subsec:theory_hrrp}}
    Synthetic range profiles can be generated using \gls{sfw} signals, this process is detailed in \cite{Wehner1995}.
    A \gls{hrrp} is a one-dimensional projection of the signal returns onto the \gls{rlos} which shows the down-range separation of object scatterers. A pulse-compression waveform produces enough data for a HRRP every pulse, a SFCW only produces enough data every M bursts. The process of generating \gls{HRR} profiles using \gls{sfw} as well as the benefits and challenges are detailed in \cite{Wehner1995}. The key idea is that the return from a single \gls{sfw} burst is a single \gls{hrrp}. The number of pulses, N, in the burst determines the number of range bins in the \gls{hrrp}. The M bursts produce M \gls{HRR} profiles which are stacked together to form an \gls{isar} image.
    
    
    % From the SFW burst returns, the N frequency samples ( 1 per pulse) containing the object are selected and isolated. The size of each sample is determined by the unambiguous range, \autoref{eq:range_unambiguous_sfw}. This isolation process is repeated for each successive burst and all the frequency samples or range bins are collated into a two-dimensional NxM data matrix, \autoref{fig:theory_data_matrix}. 
    
    % Since these values are in the frequency-domain, an IDFT is used to transform the N range bins from each burst into a synthetic HRRP. A range bin is the minimum resolution element which is resolved in a \gls{hrrp}, and can be scaled to a range value in meters using the down-range resolution equation, \autoref{eq:range_resolution_sfw}.

    %  The number of pulses, N, in a burst determines the number of range bins. A range bin is a complex voltage value (vector) at a specific range, N, in each burst, M.  The size of the range bin is determined by the range resolution, given in \autoref{eq:range_resolution} and \autoref{eq:range_resolution_sfw}. 
    \begin{figure}[ht]
        \centering
       \resizebox{0.5\linewidth}{!}{\input{Figures/02Theory/Data_matrix}}
        \caption{Two dimensional data matrix.\label{fig:theory_data_matrix}}
    \end{figure} 

    % pg 37 martorella
    %***************************************************************************************%
    \subsection{\gls{sfw} in \gls{isar} imaging}
    Although sfw allows higher BW so higher resolution, M bursts of the same waveform needs to be transmitted to obtain a single hrrp. An \gls{sfw} pulse train is used to obtain enough data about the target to form a single \gls{hrrp}. 
    The range sampling rate is the \gls{prf} which is
    \begin{equation}
        PRF = \frac{1}{\Delta T}
    \end{equation}
    and the number of pulses, N, determines the number of range cells in the \gls{hrrp} which is further discussed in \autoref{sec:theory_hrrp}. 
    Doppler resolution is dependent on the number of bursts, M, the more bursts the better the resolution.
    % Note that in the case of the stepped frequency waveform, the bandwidth is termed effective because it is synthesised from a number of discrete frequencies. The term burst refers to the transmission of a series of discrete frequency pulses. The sampling frequency is the rate at which pulses in this burst are transmitted (i.e. the real PRF). For more background on radar waveforms see Wehner [6].
    %     - Instead of collecting the target scattering information in the time domain�� a stepped frequency waveform collects the information in the frequency domain�� Once the information has b een collected in the frequency domain it is transformed into an equivalent representation in the time domain�� This transforma�� tion is normally achieved using the inverse discrete Fourier transform ��IDFT���� HRRPs collected using a stepp ed frequency waveform are referred to as synthetic HRRPs��
    % Figure ������ illustrates a stepp ed frequency waveform�� A sweep ��or burst�� of n pulses is transmitted and the in��phase ��I�� and quadrature ��Q�� receiver samples are stored for each pulse�� The frequency of each pulse di��ers from the previous pulse by ��f �� The e��ective bandwidth of the sweep is �� �� n��f �� Note that the bandwidth is called e��ective because it is synthesised from a numb er of discrete frequencies�� The time b etween pulses�� pulse repetition interval ��PRI�� is Tpri and each pulse has a length of Tp �� A HRRP is formed by transforming a sweep�� via the IDFT�� into the time domain�� In an imaging scenario�� the radar transmits N sweeps to achieve an appropriate synthetic ap erture for cross��range pro cessing��% Zywech ch 3.3.3

    - Allows the waveform's BW to be increased allowing finer resolution without shortening the pulse width
    - To have a range resolution, radar signals must have enough bandwidth through the modulation of the transmitted CW waveform.

    To achieve high range resolution, a stepped

    % chapter 2.2.3 of Martorella
    % read chater 9.1 martorella
    % 2.6.3 of Matlab
    % To have high Doppler frequency measurement, the PRF must be sufficient high to avoid Doppler ambiguities. ch2.2 Martorella
    \begin{itemize}
        \item Discuss how target range can be estimated from the SFCW returns  % chapter 2.2.3 of Martorella and 2.6.3 of Matlab
        \item Discuss how SFCW is actually sent in sequences (pulses/bursts), allowing Doppler shift measurements
        \item Discuss how doppler shifts/ angular velocity can be determined from these values.% chapter 2.2.3 of Martorella and 2.6.3 of Matlab % To have high Doppler frequency measurement, the PRF must be sufficient high to avoid Doppler ambiguities. ch2.2 Martorella
        \item (Not sure if this is good practice) Relate these concepts to pulsed waveforms and how SFCW basically achieves the best of FMCW and pulse ( ability to measure range and doppler frequency).% chapter 6.8 of Matlab
    \end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\section{Radar Imaging}
% Roll, pitch and yaw form the main components of the rotation vector and thus influence the resulting ISAR image view as shown in Figure 2.5 from Ozdemir [8]. % Meng 
% As predicted, the IPP changes significantly from frame to frame as the effective rotation vector changes rapidly due to the presence of highly varying pitch, roll, and yaw motions. % MArtorella ch12.1


% A 2-D ISAR image represents the projection of a 3-D object onto a 2-D image projection plane. When an object has 2-D rotational motion, as illustrated in Figure 2.1, the image projection plane is stationary over the CPI. However, when an object possesses 3-D rotational motion, it causes the image projection plane to vary over time. A mathematical description of the image projection plane is presented in the next section. % Yunis

% Carl Wiley of the Goodyear Aircraft Corporation was the first person who stated, in June 1951, that the Doppler frequency in the backscattered signal from a tar- get could be used to obtain fine cross range resolution for radar imaging [5]. He argued that if a relative speed exists between the radar and target, each compo- nent of the target would have a slightly different speed relative to the antenna. Precise analysis of the Doppler frequency (velocity) of the reflections through the use of the Fourier Transform, modern spectral estimation or time-frequency representations [6] will allow for the construction of a detailed image of the target. This is the fundamental principle of coherent radar imaging, specifically Synthetic Aperture Radar (SAR) and Inverse SAR (ISAR), which provide sig- nificant benefits over non-coherent imaging such as amplitude-only tomography. Therefore, the effective aperture size, or more importantly, the cross range resolution is a function of the change in angle, or rotation rate of the target [10] during the processing time. This relationship is given by Equation 2.1 [11] .
% ∆Rrc = c (2.1) 2f0 Ωef f Tobs
% Where c is the wave propagation speed, f0 is the radar operating frequency, Tobs is the observation time, or CPI and Ωeff is the modulus of the effective rotation vector of the target. % Meng
% Ωeff cannot be known before and is determined by the motion of the target. This motion is discussed later.
% Roll, pitch and yaw form the main components of the rotation vector and thus influence the resulting ISAR image view as shown in Figure 2.5 from Ozdemir [8]. % Meng
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Pomr pg 34
% Caner ch 6.5.2
\section{\gls{isar} Range-Doppler Image Formation \label{sec:theory_RD_image}} 

In real ISAR imaging scenarios, the target must be in motion with respect to the radar in such a way that there are different look angles over the \gls{cpi} in order to get aspect diverse data \cite{ISARtextbook_Matlab}. This aspect diverse data is used to form the two-dimensional range-Doppler ISAR image. Ideally, the object would only have rotational motion with respect to the radar. However in the real worl the target's undesired motion results in Doppler frequency shift-induced backscattered data that allowd range-Doppler imaging. 

% MArtorella ch2.7,3
    \begin{itemize}
        \item Discuss ISAR generates high-resolution range-Doppler image of a moving target and link back to SFCW concepts. % "ISAR generates high-resolution range-Doppler image of a moving target. For high-resolution and unambiguous range and Doppler measurements, ISAR signals must have wide band- width and satisfy certain requirement for the selection of its pulse repetition frequency (PRF). To have wide bandwidth, a multifrequency signal or a modulated continuous wave (CW) signal should be used, such as the stepped-frequency signal".\cite{ISARtextbook_Martorella} %Chapter 2.2
        \item  ISAR imaging pipeline steps % Yunus PhD 
        and \textbf{Diagram} contextualising how the HRR range profiles of the target are achieved %fig 2.20 of Martorella
        \item discuss pulse compression gain: trade-off between PRF being long to decrease doppler ambiguities but short to decrease range ambiguities
        \item image Intensity
    \end{itemize}

    %****************************************************************************%
    % SEE learning plan ISAR reviewed
    \subsection{Synthetic Aperture Radar (SAR) and \gls{isar} Background } % read chaper 12.1 martorella
    % Goal: relating SAR nad ISAR concepts to aid understanding of how the ISAR image is formed using target motion
        \begin{itemize}
            \item \textbf{Diagram} spotlight SAR vs ISAR
            \item Discuss ISAR image formation using comparisons to SAR
            \item range profile, cross-range profile concepts
            \item Briefly discuss the ISAR projection plane% chapter 2.6 Martorella
            , down-range, cross-range concepts % Martorella chapter 2.7 
        \end{itemize}
    
    \begin{itemize}
        \item As indicated in Chapter 1, inverse synthetic aperture radar (ISAR) is different from synthetic aperture radar (SAR) because the former has a larger antenna aperture based on target motion while the radar remains stationary and generates a high-resolution image of moving targets. %Martorella chapter 2
    \end{itemize}

    %****************************************************************************%
    \subsection{Motion of Object}
    In ISAR imaging, rotational movement of the target is required to form the image.
    % ch8.2.2 of Caner ISAR MAtlab
    The target’s rotational motion is defined as the movement that causes aspect change of the target from the RLOS. As thoroughly presented in Chapter 6, a small value of rotation of the target with respect to the RLOS is adaquate to form the range-Doppler ISAR image. However, when the rotation of the target is not small for the coherent integration time of the radar, the Fourier- based ISAR imaging algorithm produces degradations such as blurring and smearing in the resultant ISAR image.
    
    % pg 235 of Caner
    In most real-world applications, the target’s position with respect to radar and the target’s axial motion with respect to radar are random, as shown in Figure 6.3. If this is the situation, the target’s ISAR image is displayed on the 2D projection plane where the range axis is the RLOS axis, and the cross-range axis is the same direction as the target’s maneuver (pitch, yaw, or roll) axis,
    \subsubsection{Motion of Sea Vessels}
    - Yaw,pitch,roll with respect to sea vessels + \textbf{Diagram} to show concepts
    - tm is the major motion and 
    - explain that rmc is not a big factor in ships and requires prior knowledge of their rotation or exhaustive parameter searching to compensate for. As this is a QLP and sufficiently focused images can be secured without this step, RMC is not implemented in this report.
    - lead into motion compensation bc of image-smearing
    

    %****************************************************************************%
    \subsection{Resolving Doppler Shift}
    The phase of the returned signal from the nth point scatterer can be described as
    \begin{equation}
        \phi = e^{-j2kR_n(t)}
    \end{equation}
    where $R_n(t)$ is the radial distance of the point scatterer from the radar.

    %****************************************************************************%
    \subsection{Image Formation Pipeline}
    ISAR data is arranged in a two-dimensional matrix of range cells and number of pulses. A set of range cells for a single pulse forms a range profile. To construct the range-Doppler image (hereafter referred to as the ISAR image), the first step is performing range compression using match filtering to obtain range profiles as discussed in Chapter 3 of \cite{ISARtextbook_Martorella}. This report focuses on the steps following this process and uses data containing already constructed \gls{hrrp}s. The following sections of this chapter will expand on the processing steps to form the ISAR image. Due to the motion of an object, it can appear at different positions across range profiles. This motion can be categorised into translational and rotational motion. Motion compensation is the next step in forming the ISAR image. The goal of this step is to reduce the smearing effect that an object's motion has on the image. % INCLUDE IMAGE SHOWING WHAT THIS LOOKS LIKE i.e. image without motion and image with smearing.
    
    This report implements translational motion compensation (TMC) techniques and the the focus of subsequent sections will be contextualising and explaining concepts surrounding this. A brief explanation of rotational motion compensation (RMC) is included for completeness but techniques are not considered or implemented in this report. 
    
    \gls{isar} imaging is a two-dimensional projection of the target's scatterers onto an imaging plane. The axes of the imaging plane are cross-range, the angle between scatterers, and down-range, the distance between scatterers in meters. %Zyweck ch 2.3.2
    The resolution of both of these axes is described above.
    \gls{isar} image resolution describes the ability to resolve individual scatterers in the image. % Martorella ch1.4
    
    High range resolution profiles (HRRPs) are a projection of the scatterers onto the Radar Line of Sight (RLOS). From this the target structure can be inferred, however depending on the BW of the signal, there will be various levels of ambiguity. %Zyweck ch 2.3.2
    To achive HRRPs
    
    To obtain a useful \gls{isar} image there must be relative motion between the target and the radar. %Zyweck ch 2.5.3
    % The projection plane of an ISAR image refers to the plane onto which the target��s scattering centres are pro jected�� The orientation of the pro jection plane depends on the target��s rotational motion�� The RLOS lies in the pro jection plane and the target��s rotation vector is normal to the pro jection plane�� Since the target motion is unknown it is often di��cult to deduce the pro jection plane of an ISAR image and this makes feature extraction and subsequent classi��cation di��cult��
    
    \subsubsection{Motion Compensation}
    % Include this in the image formation pipeline
    Pure small rotational motion which is required to form an ISAR image, does not occur in measured data. The motion of an object can cause it to appear at different positions across different range profiles. This migration produces smearing and blurring in the ISAR image consequently degrading its quality. To compensate for this, \gls{tmc} and \gls{rmc} are used to form focused ISAR images. Motion compensation removes or reduces the effects of an object's translational or large rotational motion to achieve a pure small rotational motion needed to construct the ISAR image. In this report, only \gls{tmc} techniques are investigated and implemented, which will be the focus of subsequent sections. Nonetheless, for the sake of completeness, contextual information regarding \gls{rmc} is provided.
    
    The general approach to forming an \gls{isar} range-Doppler image involves several steps, namely match filtering, \gls{tmc}, \gls{rmc}, and \gls{fft} or \gls{jtf} processing. In this report, the image formation process is adapted for the specific \gls{qlp} use-case.  Specifically, pre-constructed \gls{hrrp} data is used and only \gls{tmc} techniques will be implemented, as illustrated in \autoref{fig:theory_image_formation} below. For readers looking to understand the complete process, \cite{ISARtextbook_Martorella,ISARtextbook_Matlab,yunus} are recommended.
    
    \begin{figure}[h]
        \centering
        \resizebox{\linewidth}{!}{\input{Figures/02Theory/Image_formation}}
        \caption{Block diagram showing the adapted \gls{isar} image formation process. \label{fig:theory_image_formation}}
    \end{figure}
       
    %****************************************************************************%
    \subsection{Rotational Motion Compensation (RMC)} %Martorella ch4.2
    % mention what rotational motion compensation is but do not get into the details
    
    %caner ch8.2.2
    Generally, this step is carried out after applying the \gls{tmc} because it has a smaller impact on the image's focus. It is important to remember that a slight rotation of the target in relation to the \gls{rlos} is required to generate the range-Doppler image. However, if the target undergoes significant rotation during the \gls{cpi}, the image may reamin unfocused even after applying \gls{tmc}. In such scenarios, the target's large rotational motion causes a time-varying Doppler frequency shift. This drifting cannot be compensated for by \gls{tmc} since it is influenced by the target's angular rotation rate, $\Omega$. Large rotational motion is frequently observed in targets like aircrafts or sea vessels in rough sea conditions, which are not the primary focus of investigation in this report. For further insights into the challenges posed by large target rotation and \gls{rmc} techniques, refer to \cite{ISARtextbook_Martorella,ISARtextbook_Matlab}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Martorella ch4
\section{Translational Motion Compensation (TMC)}

TMC includes range alignment and phase adjustment or phase correction. Range alignment is accomplished by tracking the movement of a prominent scatterer with strong peak in range profiles. This is called the coarse range alignment, which allows the prominent scatterer to be sorted into the same range cell across the range profiles. The accuracy of the alignment is limited by the range resolution cell. However, only the coarse range alignment is not sufficient for removing phase drift errors in the range profiles. Con- sequently, a suitable phase adjustment procedure must be carried out to remove the residual phase errors and drifts.
Translational motion can be compensated for by aligning range profiles through shifting a necessary number of range cells, such that the received signals from the same scatterer are always kept in the same range cell. This is called the range-cell alignment or range tracking, which is the coarse motion compensation. However, due to the shifting in range cells, it also causes phase drifts. Thus, a phase adjustment procedure must be applied to remove the phase

% Martorella ch4
Translational motion causes the scatterers of an object to appear at different positions in different range profiles. This 
%TMC includes range alignment and phase adjustment or phase correction. Range alignment is accomplished by tracking the movement of a prominent scatterer with strong peak in range profiles. This is called the coarse range alignment, which allows the prominent scatterer to be sorted into the same range cell across the range profiles. The accuracy of the alignment is limited by the range resolution cell. However, only the coarse range alignment is not sufficient for removing phase drift errors in the range profiles. Con- sequently, a suitable phase adjustment procedure must be carried out to remove the residual phase errors and drifts.

    %****************************************************************************%
    \subsection{Range Alignment (\gls{ra})}
    % only discuss the general concept and include an image. Do not meantion correlation as a technique- this should go in the literature review.
    \begin{itemize}
        \item Refer back to imaging pipeline
        \item what it is and what it compensates for and how it helps focus the image
        \item \textbf{Diagram} image before and after RA
    \end{itemize}

    
    % Taken from the V&V chapter
    Range alignment is usually achieved by aligning the the strongest magnitude peak in each range profile. Cross-correlation is a simple and commonly used approach to finding misaligned range cells with respect to the range cells in a preselected reference profile. It compares the location of the maximum peak in the reference profile to that of the misaligned profile.
    
    The peak location of the cross-correlation return is used to estimate the integer number of bins the misaligned profile has drifted by compared to the reference profile. This estimation is used to shift the misaligned range cells into the correct range bin, thereby aligning the profile with the reference profile. This procedure is repeated for all range profiles, aligning the \gls{ds} in all range profiles. The reference profile can be chosen arbitrarily, however, choosing the profile that shows higher peaks near the center of its range cells will ensure that the target image is centered. Cross-correlation can be performed in the time or frequency domain, since the frequency domain is a multiplication operation it is faster than time-domain correlation \cite{ISARtextbook_Martorella}. %chapter 4.1.1.

    %****************************************************************************%
    \subsection{Autofocus (\gls{af})}
    HRRP: To measure the Doppler shift, we need to measure the change in phase between the transmitted and echoed signal at the same reference point (L). Hence processing occurs in the slow-time dimension (we compare the value sampled from different pulses at the same sample number). 
    \begin{itemize}
        \item Refer back to imaging pipeline
        \item what it is and what it compensates for and how it helps focus the image
        \item \textbf{Diagram} image before and after AF
    \end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Important Concepts in \gls{isar}} \label{sec:theory_isar_complications}

    %****************************************************************************%
    \subsubsection{Considerations for ISAR Images}
    - chapter 12.1 and 12.5 and 12.4 on rough seas and small boats and sea clutter that causes limitations of the ISAR image
    \begin{itemize}
        \item this section will discuss complexities surrounding non-suitable ISAR images which will lead into the following subsections/sections on RA, AF and CPTWL
        \item effects of complex target motion
        \item effects of sidelobes causing doppler spreading
    \end{itemize}

    %****************************************************************************%
    \subsection{Sidelobes}
    Generally in frequency modulated waveforms, high sidelobes appear adjacent to or near the mainlobe, and decrease with distance from the mainlobe. The high peak sidelobes are a result of the spectrum’s sharp transition in frequency between pulses.
    FIGURE OF SIDELOBES
    Noise, specifically that affects the phase, can lead to large signal sidelobes which results in Doppler spreading. 
    When large sidelobes appear in \gls{isar} data they distort the image. The distortion appears as spreading of a scatterer power across the doppler spectrum. Specifically, after \gls{af}, the power of a scatterer will remain in its range bin but be spread over the Doppler. 

    Sidelobes result in energy from the echo of a target being present in the data samples adjacent to those that correspond to the actual target location.  % pomr pg693
    Both peak and integrated sidelobe ratios are important performance metrics. Integrated sidelobe levels are relevant when operating in a distributed clutter environment, as the cumulative sidelobe contributions associated with clutter may degrade the quality of a target measurement. For example, integrated sidelobes contribute to the multiplicative noise in a synthetic aperture radar (SAR) image [10]. %pomr ch20.2.10
    Pulse compression waveforms exhibit range sidelobes that extend over a time interval equal to twice the pulse width and that are a function of the modulation employed. Sidelobes degrade radar performance by placing energy up and down range from its source. For example, range sidelobes associated with a large RCS target may mask the presence of a smaller target located within a pulse width of the larger target; thus, “low” sidelobes are a desirable property. %ch20.7.5
    For example, an HRR profile of a vehicle contains returns from scatterers located on the vehicle and returns from neighboring terrain projected onto the vehicle through the range sidelobes. Patches of resolved terrain contribute sidelobe energy onto the vehicle’s range profile. The sidelobe energy, originating from resolved patches distributed in range, adds noncoherently at ranges associated with the vehicle. The cumulative, noncoherent contribution may be sufficient to degrade the HRR profile.
    
The integrated sidelobe ratio is defined as the ratio of the energy in the sidelobes to the energy in the mainlobe. Integrated sidelobes are a source of multiplicative noise [10] and must be weighted by the average power in the range cells containing the interference to determine their impact. The integrated sidelobe ratio for an unweighted LFM waveform is approximately −9.6 dB [29]. Amplitude weighting lowers the peak sidelobe and reduces the integrated sidelobe ratio (ISR; see Section 20.9). %ch20.7.5
Further discused in 3.3 of Martorella.
    Discuss what sidelobes are and what caises them. 
    A simple hamming window is applied in this implementation however more effective filters exist as discussed in \cite{ISARtextbook_Martorella}.
    Discuss How the filter window can reduce the sidelobes but then discuss the types of filters available in the Lit review not in the theory section. Taylor weighting %poomr ch20.9
    
    Filtering can be applied to reduce the sidelobes but will likely result in snr reduction and loss in resolution. % pomr pg 648
    
    %!!!!!!!!!!!!!!!!!! NB:
    Spectral spreading is caused by sidelobes that form when the \gls{fft} is applied. Throughout this report, a simple hamming window is applied before using this \gls{fft} to reduce the spreading however, more aggressive filters exist as discussed in \cite{ISARtextbook_Martorella}. Windowing was used to reduce the sidelobes before forming the \gls{isar} images in this report but it was not always found to fully effictive.
    %****************************************************************************%
    \subsection{\gls{isar} Image Contrast} % chapter 12.1 of Martorella
    As discussed in \cite{image_contrast}, \gls{ic} can be used to measure the focus of an image. The idea behind this is that in a focused image, the power of target scatterers is less spread and so become more pronounced than in an unfocused image. The \gls{ic} is calculated using the intensity and mean power of the image:
    \begin{equation} \label{eq:image_contrast}
    IC = \frac{\sqrt{(I-A\{I\})^2}}{A\{I\}}
    \end{equation}
    Where \(I\) is the intensity of all range bins in the image calculated as \(|amplitude|^2\) and \(A\) is the mean function.
    
    %****************************************************************************%
    \subsection{Coherent Processing Interval (CPI)}
    \begin{itemize}
        \item Discuss CPTWL and effects of that on resolution, the ISAR image, etc
        % Martorella pg 191
    \end{itemize}

    


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Summary}
\emph{This section might not be necessary, all depends how I am able to link up the other sections. I want to make sure that the context and flow of concepts make sense in terms of the report.}
\begin{itemize}
    \item Discuss RA and AF linking with CPI to form focused ISAR images
\end{itemize}



% ----------------------------------------------------
\ifstandalone
\bibliography{../Bibliography/References.bib}
\printnoidxglossary[type=\acronymtype,nonumberlist]
\fi
\end{document}
% ----------------------------------------------------